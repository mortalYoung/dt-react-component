"use strict";(self.webpackChunkdt_react_component=self.webpackChunkdt_react_component||[]).push([[2019],{98151:function(Me,R,e){e.r(R);var Ce=e(80244),ee=e.n(Ce),K=e(59058),Y=e(79685),s=e(94046),C=e(39087),l=e(70730),a=e(13301),O=e(24425),T=e(63342);R.default=function(){return(0,T.jsx)(a.Z,{style:{height:400},config:{tooltips:!0,highlight:!0},graphData:[{taskId:"test-1",taskName:"\u4F60\u597D-1",childNode:[{taskId:"test-11",taskName:"\u4F60\u597D-11",childNode:[]},{taskId:"test-12",taskName:"\u4F60\u597D-12",childNode:[{taskId:"test-21",taskName:"\u4F60\u597D-21",childNode:[{taskId:"test-31",taskName:"\u4F60\u597D-31",childNode:[]}]}]}]}],onDrawVertex:function(){return"whiteSpace=wrap;fillColor=#f5ffe6;strokeColor=#12bc6a;"},onRenderActions:function(k){return(0,T.jsxs)("div",{style:{display:"grid",gridGap:5,gridTemplateColumns:"15px 15px"},children:[(0,T.jsx)(K.default,{title:"\u653E\u5927",children:(0,T.jsx)(C.Z,{onClick:function(){return k.zoomIn()}})}),(0,T.jsx)(K.default,{title:"\u7F29\u5C0F",children:(0,T.jsx)(l.Z,{onClick:function(){return k.zoomOut()}})})]})},onRenderCell:function(k){if(k.vertex&&k.value){var V=k.value;if(V)return s.renderToString((0,T.jsxs)("div",{children:[(0,T.jsx)("span",{children:V.taskName}),(0,T.jsx)("br",{}),(0,T.jsx)("span",{children:V.taskId})]}))}return""},onRenderTooltips:function(k){return k.vertex&&k.value?k.value.taskName:""}})}},70154:function(Me,R,e){e.r(R);var Ce=e(79685),ee=e(94046),K=e(13301),Y=e(24425),s=e(63342);R.default=function(){return(0,s.jsx)(K.Z,{style:{height:400},config:{tooltips:!1,highlight:!0},graphData:[{taskId:"test-1",taskName:"\u4F60\u597D-1",taskType:1,childNode:[{taskId:"test-11",taskName:"\u4F60\u597D-11",taskType:2,childNode:[]},{taskId:"test-12",taskName:"\u4F60\u597D-12",taskType:3,childNode:[{taskId:"test-21",taskName:"\u4F60\u597D-21",taskType:4,childNode:[{taskId:"test-31",taskName:"\u4F60\u597D-31",taskType:5,childNode:[]}]}]}]}],onDrawVertex:function(l){var a=["#fffbe6","#e6f6ff","#f5ffe6","#fff1f0","#e6e9f2"],O=["#fdb313","#3f87ff","#12bc6a","#fe615c","#5b6da6"];return"whiteSpace=wrap;fillColor="+a[l.taskType-1]+";strokeColor="+O[l.taskType-1]+";"},onContextMenu:function(l,a){var O=["\u6267\u884C\u4E2D","\u90E8\u7F72\u4E2D","\u53D6\u6D88\u4E2D","\u8FD0\u884C\u6210\u529F","\u8FD0\u884C\u5931\u8D25"];return a.vertex?[{id:"operation",title:O[l.taskType-1],callback:function(){alert("\u5F53\u524D vertex \u5904\u4E8E"+O[l.taskType-1])}},{id:"remove",title:"\u5220\u9664\u5F53\u524D\u8282\u70B9",callback:function(){console.log("\u5220\u9664")}}]:[{id:"remove",title:"\u5220\u9664\u8FDE\u7EBF",callback:function(){console.log("\u5220\u9664")}}]},onRenderCell:function(l){if(l.vertex&&l.value){var a=l.value;if(a)return ee.renderToString((0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:a.taskName}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:a.taskId})]}))}return""}})}},12463:function(Me,R,e){e.r(R);var Ce=e(79685),ee=e(94046),K=e(13301),Y=e(24425),s=e(63342);R.default=function(){return(0,s.jsx)(K.Z,{enableDrag:!0,style:{height:400},config:{tooltips:!1,connectable:!0,highlight:!0},graphData:[{taskId:"test-1",taskName:"\u4F60\u597D-1",taskType:1,childNode:[{taskId:"test-11",taskName:"\u4F60\u597D-11",taskType:2,childNode:[]},{taskId:"test-12",taskName:"\u4F60\u597D-12",taskType:3,childNode:[{taskId:"test-21",taskName:"\u4F60\u597D-21",taskType:4,childNode:[{taskId:"test-31",taskName:"\u4F60\u597D-31",taskType:5,childNode:[]}]}]}]}],onDropWidgets:function(l,a,O,T,b){console.group("onDropWidgets"),console.log("node:",l),console.log("graph:",a),console.log("target:",O),console.log("x and y:",T,b),console.groupEnd();var k="randomId__"+new Date().valueOf();a.insertVertex(a.getDefaultParent(),k,{taskName:l.innerText,taskId:k},T,b,210,50,"whiteSpace=wrap;fillColor=#f5ffe6;strokeColor=#12bc6a;")},onCellsChanged:function(l){console.group("onCellsChanged"),console.log("cell:",l),console.groupEnd()},onDrawVertex:function(){return"whiteSpace=wrap;fillColor=#f5ffe6;strokeColor=#12bc6a;"},onRenderCell:function(l){if(l.vertex&&l.value){var a=l.value;if(a)return ee.renderToString((0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:a.taskName}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:a.taskId})]}))}return""},onGetPreview:function(l){var a=document.createElement("div");return a.style.width="210px",a.style.height="50px",a.style.border="1px solid #ddd",a.style.textAlign="center",a.dataset.name=l.innerText,a.innerHTML=ee.renderToString((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"\u65B0\u8282\u70B9"}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:l.innerText})]})),a},onRenderWidgets:function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{height:20,background:"#ddd"},children:"\u62D6\u62FD\u7EC4\u4EF6"}),(0,s.jsxs)("ul",{style:{listStyle:"none",margin:0,padding:0},children:[(0,s.jsx)("li",{className:K.Y+"__",style:{cursor:"move",margin:"5px 0"},children:"\u4F60\u597D1"}),(0,s.jsx)("li",{className:K.Y+"__",style:{cursor:"move",margin:"5px 0"},children:"\u4F60\u597D2"}),(0,s.jsx)("li",{className:K.Y+"__",style:{cursor:"move",margin:"5px 0"},children:"\u4F60\u597D3"}),(0,s.jsx)("li",{className:K.Y+"__",style:{cursor:"move",margin:"5px 0"},children:"\u4F60\u597D4"})]})]})}})}},80490:function(Me,R,e){e.r(R);var Ce=e(79685),ee=e(94046),K=e(13301),Y=e(24425),s=e(63342);R.default=function(){return(0,s.jsx)(K.Z,{style:{height:400},config:{tooltips:!1,highlight:!0},graphData:[{taskId:"test-1",taskName:"\u4F60\u597D-1",taskType:1,childNode:[{taskId:"test-11",taskName:"\u4F60\u597D-11",taskType:2,childNode:[]},{taskId:"test-12",taskName:"\u4F60\u597D-12",taskType:3,childNode:[{taskId:"test-21",taskName:"\u4F60\u597D-21",taskType:4,childNode:[{taskId:"test-31",taskName:"\u4F60\u597D-31",taskType:5,childNode:[]}]}]}]}],onClick:function(l,a,O){console.group("onClick"),console.log("\u5F53\u524D\u70B9\u51FB\u7684 cell \u662F:",l),console.log("\u5F53\u524D\u70B9\u51FB\u7684 graph \u662F:",a),console.log("\u5F53\u524D\u70B9\u51FB\u7684 dom \u662F:",O.target),console.groupEnd()},onDoubleClick:function(l,a,O){console.group("onDoubleClick"),console.log("\u5F53\u524D\u70B9\u51FB\u7684 cell \u662F:",l),console.log("\u5F53\u524D\u70B9\u51FB\u7684 graph \u662F:",a),console.log("\u5F53\u524D\u70B9\u51FB\u7684 dom \u662F:",O.target),console.groupEnd()},onContainerChanged:function(l){console.group("onContainerChanged"),console.log(l),console.groupEnd()},onKeyDown:function(){return[{id:"remove",method:"bindControlKey",keyCode:8,func:function(){alert("\u5220\u9664")}}]},onContextMenu:function(){return[{id:"remove",title:"\u5220\u9664"}]},onDrawVertex:function(){return"whiteSpace=wrap;fillColor=#f5ffe6;strokeColor=#12bc6a;"},onRenderCell:function(l){if(l.vertex&&l.value){var a=l.value;if(a)return ee.renderToString((0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:a.taskName}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:a.taskId})]}))}return""}})}},67123:function(Me,R,e){e.r(R);var Ce=e(70300),ee=e.n(Ce),K=e(48651),Y=e.n(K),s=e(5677),C=e.n(s),l=e(86516),a=e.n(l),O=e(79685),T=e(94046),b=e(13301),k=e(24425),V=e(63342);R.default=function(){var be=(0,O.useState)(!1),Le=a()(be,2),_=Le[0],te=Le[1],Re=(0,O.useState)("b"),De=a()(Re,2),Ee=De[0],ie=De[1],ue=(0,O.useState)([{metaId:"1",metaInfo:{name:"tableName",type:1,list:["a","b","c","d"]},childNode:[{metaId:"2",metaInfo:{name:"tableName",type:2,list:["1-c"]}},{metaId:"3",metaInfo:{name:"tableName",type:2,list:["1-c"]}}]}]),U=a()(ue,2),A=U[0],Oe=U[1],ne=function(f){return f.metaId==="1"?{width:194,height:120}:{width:196,height:54}};return(0,V.jsx)(b.Z,{direction:"west",loading:_,style:{height:400},vertexSize:{width:196,height:54},config:{tooltips:!1,connectable:!1,highlight:!1,vertexMovable:!1,defaultEdgeStyle:function(f){var y,P=f.mxConstants,I=f.mxEdgeStyle;return y={},C()(y,P.STYLE_ROUNDED,1),C()(y,P.STYLE_CURVED,0),C()(y,P.STYLE_EDGE,I.EntityRelation),y},getPortOffset:function(f,y){var P=f[y?"visibleSourceState":"visibleTargetState"].text.node.querySelectorAll("div")[1],I=P.querySelector("li[data-id="+Ee+"]")||P.querySelector("li");return I}},vertexKey:"metaId",onClick:function(f,y,P){f.value.metaId==="1"&&(te(!0),setTimeout(function(){var I,oe=[Y()(Y()({},A[0]),{},{childNode:[],parentNode:[]})],le=Math.random()>.5?"childNode":"parentNode",we=Math.floor(Math.random()*5+1);(I=oe[0][le]).push.apply(I,ee()(new Array(we).fill({}).map(function(Ne,Be){return{metaId:"1-"+Be,metaInfo:{name:"tableName",type:2,list:["1-c"]}}})));var ce=P.target;ie(ce.dataset.id),Oe(oe),te(!1)},300))},onGetSize:ne,graphData:A,onDrawVertex:function(){return"whiteSpace=wrap;fillColor=#ffffff;strokeColor=#7460EF;"},onDrawEdge:function(){return"whiteSpace=wrap;fillColor=#ffffff;strokeColor=#7460EF;"},onRenderCell:function(f){if(f.vertex&&f.value){var y=f.value;if(y){var P=ne(y);return T.renderToString((0,V.jsxs)("div",{style:{overflow:"hidden",width:P.width,height:P.height},children:[y.metaInfo.name,(0,V.jsx)("hr",{style:{borderTop:"1px solid #ddd",margin:0}}),(0,V.jsx)("div",{style:{width:"100%",overflow:"auto"},children:(0,V.jsx)("ul",{style:{listStyle:"none",margin:0,padding:0},children:y.metaInfo.list.map(function(I){return(0,V.jsx)("li",{"data-id":I,style:{height:20,borderBottom:"1px solid #ddd",background:Ee===I?"red":"transparent"},children:I},I)})})})]}))}}return""}})}},33392:function(Me,R,e){e.r(R),e.d(R,{default:function(){return te}});var Ce=e(71089),ee=e(75020),K=e(80244),Y=e(59058),s=e(5677),C=e.n(s),l=e(70300),a=e.n(l),O=e(86516),T=e.n(O),b=e(79685),k=e(94046),V=e(13301),be=[{metaId:"test-1",metaInfo:{name:"tableName",type:1},childNode:[{metaId:"test-2",metaInfo:{name:"tableName2",type:2}},{metaId:"test-3",metaInfo:{name:"tableName3",type:2}},{metaId:"test-4",metaInfo:{name:"tableName4",type:2}},{metaId:"test-5",metaInfo:{name:"tableName5",type:2}}],parentNode:[{metaId:"test-6",metaInfo:{name:"tableName6",type:3}},{metaId:"test-7",metaInfo:{name:"tableName7",type:3}},{metaId:"test-8",metaInfo:{name:"tableName8",type:3}},{metaId:"test-9",metaInfo:{name:"tableName9",type:3}}]}],Le=e(24425),_=e(63342),te=function(){var Re=(0,b.useState)(!1),De=T()(Re,2),Ee=De[0],ie=De[1],ue=(0,b.useState)(a()(be)),U=T()(ue,2),A=U[0],Oe=U[1];return(0,_.jsx)(V.Z,{direction:"west",loading:Ee,style:{height:300},vertexSize:{width:196,height:54},config:{tooltips:!1,connectable:!1,highlight:!1,toolbarStyle:{bottom:100,right:0,top:"initial"},defaultEdgeStyle:function(u){var f,y=u.mxConstants,P=u.mxEdgeStyle;return f={},C()(f,y.STYLE_ROUNDED,1),C()(f,y.STYLE_CURVED,0),C()(f,y.STYLE_EDGE,P.EntityRelation),f}},vertexKey:"metaId",onContextMenu:function(u,f){return f.vertex?[{id:"insert",title:"\u63D2\u5165"},{id:"remove",title:"\u5220\u9664"}]:[]},onClick:function(u,f,y){var P=y.target;P.closest(".loadData")&&(ie(!0),setTimeout(function(){Oe(function(I){for(var oe=a()(I);oe.length;){var le=oe.pop();if(le.metaId===u.value.metaId){var we="randomId__"+new Date().valueOf(),ce=u.value.metaInfo.type===2?"childNode":"parentNode";le[ce]=le[ce]||[],le[ce].push({metaId:we,metaInfo:{name:we+"tableName",type:le.metaInfo.type}});break}oe.push.apply(oe,a()(le.childNode||[])),oe.push.apply(oe,a()(le.parentNode||[]))}return a()(I)}),ie(!1)},300))},graphData:A,onDrawVertex:function(u){return["","whiteSpace=wrap;fillColor=#ffffff;strokeColor=#3F87FF;","whiteSpace=wrap;fillColor=#ffffff;strokeColor=#7460EF;","whiteSpace=wrap;fillColor=#ffffff;strokeColor=#26D6AE;"][u.metaInfo.type]},onDrawEdge:function(u,f){return u.value.metaInfo.type===3?"whiteSpace=wrap;fillColor=#ffffff;strokeColor=#26D6AE;":f.value.metaInfo.type===2?"whiteSpace=wrap;fillColor=#ffffff;strokeColor=#7460EF;":"whiteSpace=wrap;fillColor=#ffffff;strokeColor=#3F87FF;"},onRenderActions:function(u,f){var y=f.mxOutline;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,_.jsx)("button",{onClick:function(){return u.center(!0,!0)},children:(0,_.jsx)(Y.default,{title:"\u5C45\u4E2D",children:"center"})}),(0,_.jsx)("button",{onClick:function(){return ee.default.success("download successfully")},children:(0,_.jsx)(Y.default,{title:"\u4E0B\u8F7D",children:"download"})})]}),(0,_.jsxs)("div",{style:{marginTop:10},children:[(0,_.jsx)("button",{onClick:function(){var I=document.getElementById("outline");I.innerHTML?I.innerHTML="":new y(u,I)},children:(0,_.jsx)(Y.default,{title:"\u5BFC\u822A\u5668",children:"navigator"})}),(0,_.jsx)("div",{id:"outline"})]})]})},onRenderCell:function(u){if(u.vertex&&u.value){var f=u.value;if(f){var y,P=f.metaInfo.type===3,I=P?"left":"right";return k.renderToString((0,_.jsxs)("div",{style:{position:"relative",width:196,height:54,paddingTop:10},children:[(0,_.jsx)("span",{children:f.metaInfo.name}),f.metaInfo.type!==1&&(0,_.jsx)("img",{className:"loadData",width:14,height:14,style:(y={cursor:"pointer",position:"absolute"},C()(y,I,0),C()(y,"top","50%"),C()(y,"transform","translate("+(P?"-50%":"50%")+",-50%)"),y),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAAXNSR0IArs4c6QAAADNQTFRFAAAAscTOtr/Isb7HsLzGsL7Frr3Fr73Gr7zFr73Frr3FrrzFrrzGrrzF5+vt5+vu////mHsMmQAAAA10Uk5TABocTmtum7bZ8vP8/XH+TQkAAACASURBVCjPdVLZAoAgCMMjb8r//9oOjazcnpApzAFRg7Y+pBS81TRCucwd2aknbyIPiObOL4VfKEu//8kfzPVGRf4hnn2cHLdNQnfoFD1cq4RZk+UZwZb8nPAU5kSg1PpWQVOQ/sTaCVgKNody4QdHS9bREmwitB0PCo8WL8NsfXarIha/m4rePQAAAABJRU5ErkJggg=="})]}))}}return""},children:function(){return(0,_.jsx)("div",{children:(0,_.jsxs)("ul",{style:{listStyle:"none",display:"flex",justifyContent:"center",gap:"15px"},children:[(0,_.jsxs)("li",{children:[(0,_.jsx)("div",{style:{display:"inline-block",width:12,height:12,marginRight:5,background:"rgb(38, 214, 174)"}}),"1"]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("div",{style:{display:"inline-block",width:12,height:12,marginRight:5,background:"rgb(63, 135, 255)"}}),"2"]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("div",{style:{display:"inline-block",width:12,height:12,marginRight:5,background:"rgb(116, 96, 239)"}}),"3"]})]})})}})}},13301:function(Me,R,e){e.d(R,{Y:function(){return We},Z:function(){return Qe}});var Ce=e(16842),ee=e(81901),K=e(22786),Y=e.n(K),s=e(46299),C=e.n(s),l=e(48651),a=e.n(l),O=e(86516),T=e.n(O),b=e(79685),k=e(32810),V=e.n(k),be=e(12903),Le=e.n(be),_=e(5677),te=e.n(_),Re=e(3206),De=e.n(Re),Ee=function(){function E(){var W=this;V()(this,E),te()(this,"layoutEventHandler",function(){}),te()(this,"mxInstance",void 0),te()(this,"mxGraph",null),te()(this,"getDefaultVertexStyle",function(){var m=W.mxInstance,t=m.mxConstants,L=m.mxPerimeter,c=[];return c[t.STYLE_SHAPE]=t.SHAPE_RECTANGLE,c[t.STYLE_PERIMETER]=L.RectanglePerimeter,c[t.STYLE_ALIGN]=t.ALIGN_CENTER,c[t.STYLE_VERTICAL_ALIGN]=t.ALIGN_MIDDLE,c[t.STYLE_FONTSIZE]="12",c[t.STYLE_FONTFAMILY]="PingFangSC-Regular",c[t.FONT_BOLD]="normal",c[t.STYLE_WHITE_SPACE]="nowrap",c[t.STYLE_FONTSTYLE]=1,c}),te()(this,"getDefaultEdgeStyle",function(){var m=W.mxInstance,t=m.mxConstants,L=m.mxEdgeStyle,c=[];return c[t.STYLE_SHAPE]=t.SHAPE_CONNECTOR,c[t.STYLE_STROKECOLOR]="#3f87ff",c[t.STYLE_STROKEWIDTH]=1,c[t.STYLE_ALIGN]=t.ALIGN_CENTER,c[t.STYLE_VERTICAL_ALIGN]=t.ALIGN_MIDDLE,c[t.STYLE_EDGE]=L.TopToBottom,c[t.STYLE_ENDARROW]=t.ARROW_BLOCK,c[t.STYLE_FONTSIZE]="10",c[t.STYLE_ROUNDED]=!1,c}),te()(this,"initContainerScroll",function(){var m=W.mxInstance,t=m.mxRectangle,L=m.mxPoint,c=m.mxUtils;if(W.mxGraph){var h=W.mxGraph;h.scrollTileSize=new t(0,0,200,200),h.getPagePadding=function(){return new L(Math.max(0,Math.round(h.container.offsetWidth-34)),Math.max(0,Math.round(h.container.offsetHeight-34)))},h.getPageSize=function(){return this.pageVisible?new t(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.scrollTileSize},h.getPageLayout=function(){var o=this.pageVisible?this.getPageSize():this.scrollTileSize,p=this.getGraphBounds();if(p.width===0||p.height===0)return new t(0,0,1,1);var z=Math.ceil(p.x/this.view.scale-this.view.translate.x),se=Math.ceil(p.y/this.view.scale-this.view.translate.y),de=Math.floor(p.width/this.view.scale),q=Math.floor(p.height/this.view.scale),H=Math.floor(z/o.width),S=Math.floor(se/o.height),me=Math.ceil((z+de)/o.width)-H,ge=Math.ceil((se+q)/o.height)-S;return new t(H,S,me,ge)},h.view.getBackgroundPageBounds=function(){var o=this.graph.getPageLayout(),p=this.graph.getPageSize();return new t(this.scale*(this.translate.x+o.x*p.width),this.scale*(this.translate.y+o.y*p.height),this.scale*o.width*p.width,this.scale*o.height*p.height)},h.getPreferredPageSize=function(){var o=this.getPageLayout(),p=this.getPageSize();return new t(0,0,o.width*p.width,o.height*p.height)};var Pe=h.view.validate;h.view.validate=function(){if(this.graph.container!=null&&c.hasScrollbars(this.graph.container)){var o=this.graph.getPagePadding(),p=this.graph.getPageSize();this.translate.x=o.x/this.scale-(this.x0||0)*p.width,this.translate.y=o.y/this.scale-(this.y0||0)*p.height}Pe.apply(this,arguments)};var ye=h.sizeDidChange;h.sizeDidChange=function(){if(this.container!=null&&c.hasScrollbars(this.container)){var o=this.getPageLayout(),p=this.getPagePadding(),z=this.getPageSize(),se=Math.ceil(2*p.x/this.view.scale+o.width*z.width),de=Math.ceil(2*p.y/this.view.scale+o.height*z.height),q=h.minimumGraphSize;(q===null||q.width!==se||q.height!==de)&&(h.minimumGraphSize=new t(0,0,se,de));var H=p.x/this.view.scale-o.x*z.width,S=p.y/this.view.scale-o.y*z.height;if(!this.autoTranslate&&(this.view.translate.x!==H||this.view.translate.y!==S)){this.autoTranslate=!0,this.view.x0=o.x,this.view.y0=o.y;var me=h.view.translate.x,ge=h.view.translate.y;h.view.setTranslate(H,S),h.container.scrollLeft+=(H-me)*h.view.scale,h.container.scrollTop+=(S-ge)*h.view.scale,this.autoTranslate=!1}ye.apply(this,arguments)}}}}),this.mxInstance=De()(E.config)}return Le()(E,[{key:"create",value:function(m,t){var L,c,h=this.mxInstance,Pe=h.mxGraphView,ye=h.mxText,o=h.mxGraph,p=h.mxEvent,z=h.mxConstants,se=h.mxGraphHandler,de=h.mxSvgCanvas2D,q=h.mxClient,H=h.mxPoint;de.prototype.updateStroke=function(){var d=this.state,D=String(d.strokeColor);this.node.setAttribute("stroke",D.startsWith("const")?D:D.toLowerCase()),(d.alpha<1||d.strokeAlpha<1)&&this.node.setAttribute("stroke-opacity",d.alpha*d.strokeAlpha);var Z=this.getCurrentStrokeWidth();Z!==1&&this.node.setAttribute("stroke-width",Z),this.node.nodeName==="path"&&this.updateStrokeAttributes(),d.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern((d.fixDash?1:d.strokeWidth)*d.scale))},de.prototype.updateFill=function(){var d=this.state;if((d.alpha<1||d.fillAlpha<1)&&this.node.setAttribute("fill-opacity",d.alpha*d.fillAlpha),d.fillColor!=null)if(d.gradientColor!=null){var D=this.getSvgGradient(String(d.fillColor),String(d.gradientColor),d.gradientFillAlpha,d.gradientAlpha,d.gradientDirection);if(!q.IS_CHROMEAPP&&!q.IS_IE&&!q.IS_IE11&&!q.IS_EDGE&&this.root.ownerDocument===document){var Z=this.getBaseUrl().replace(/([()])/g,"\\$1");this.node.setAttribute("fill","url(".concat(Z,"#").concat(D,")"))}else this.node.setAttribute("fill","url(#".concat(D,")"))}else{var $=String(d.fillColor);this.node.setAttribute("fill",$.startsWith("const")?$:$.toLowerCase())}},Pe.prototype.optimizeVmlReflows=!1,ye.prototype.ignoreStringSize=!0,se.prototype.guidesEnabled=!0,p.disableContextMenu(m);var S=new o(m);this.mxGraph=S,S.setPanning(!0),S.panningHandler.useLeftButtonForPanning=!0,S.setTooltips((L=t==null?void 0:t.tooltips)!==null&&L!==void 0?L:!0),S.view.setScale(1),S.setHtmlLabels(!0),S.setAllowDanglingEdges(!1),S.setConnectable((c=t==null?void 0:t.connectable)!==null&&c!==void 0?c:!1),S.isCellsMovable=function(){var d=t==null?void 0:t.vertexMovable;if(d===!0||d===void 0){var D=S.getSelectionCell();return!(D&&D.edge)}return!1},S.isCellEditable=function(){return!1},S.isCellResizable=function(){return!1};var me=typeof(t==null?void 0:t.defaultVertexStyle)=="function"?t.defaultVertexStyle(this.mxInstance):t==null?void 0:t.defaultVertexStyle;S.getStylesheet().putDefaultVertexStyle(a()(a()({},this.getDefaultVertexStyle()),me||{}));var ge=typeof(t==null?void 0:t.defaultEdgeStyle)=="function"?t.defaultEdgeStyle(this.mxInstance):t==null?void 0:t.defaultEdgeStyle;S.getStylesheet().putDefaultEdgeStyle(a()(a()({},this.getDefaultEdgeStyle()),ge||{})),Pe.prototype.updateFloatingTerminalPoint=function(d,D,Z,$){if(t!=null&&t.getPortOffset){var _e=this.getNextPoint(d,Z,$);if(!D.text)return;var ke=D.text.node.getElementsByTagName("div")[1],F=D.x,Se=D.getCenterY();if(_e.x>F+D.width/2&&(F+=D.width),ke!=null){var he;Se=D.getCenterY()-ke.scrollTop;var n=t==null||(he=t.getPortOffset)===null||he===void 0?void 0:he.call(t,d,$);n&&(Se=je(D,n)),d!=null&&d.absolutePoints!=null&&(_e.y=Se)}d.setAbsoluteTerminalPoint(new H(F,Se),$)}else d.setAbsoluteTerminalPoint(this.getFloatingTerminalPoint(d,D,Z,$),$)};var je=function(D,Z){var $=Z.parentNode.parentNode.parentElement,_e=Z.offsetTop-$.offsetTop+Z.offsetHeight/2;return D.y+_e};return z.HANDLE_FILLCOLOR="#ffffff",z.HANDLE_STROKECOLOR="#2491F7",z.VERTEX_SELECTION_COLOR="transparent",z.CURSOR_MOVABLE_VERTEX="pointer",z.STYLE_OVERFLOW="hidden",S}},{key:"createRubberBand",value:function(){var m=this.mxInstance.mxRubberband;if(!this.mxGraph)throw new Error("Please call create before createRubberBand");return new m(this.mxGraph)}},{key:"renderVertex",value:function(m){this.mxGraph&&(this.mxGraph.getLabel=function(t){return t&&t.vertex?m(t):""})}},{key:"renderTooltips",value:function(m){var t=this;this.mxGraph&&(this.mxGraph.getTooltipForCell=function(L){if(L&&L.vertex){var c=m(L);return c===void 0?t.mxGraph.getLabel(L):c}return""})}},{key:"setView",value:function(m){var t=m.scale,L=m.dx,c=m.dy;this.mxGraph&&(this.mxGraph.view.setScale(t),this.mxGraph.view.setTranslate(L,c))}},{key:"resetScrollPosition",value:function(){if(this.mxGraph&&this.mxGraph.container){var m=this.mxGraph,t=m.getGraphBounds(),L=Math.max(t.width,m.scrollTileSize.width*m.view.scale),c=Math.max(t.height,m.scrollTileSize.height*m.view.scale);m.container.scrollTop=Math.floor(Math.max(0,t.y-Math.max(20,(m.container.clientHeight-c)/2))),m.container.scrollLeft=Math.floor(Math.max(0,t.x-Math.max(0,(m.container.clientWidth-L)/2)))}}},{key:"dispose",value:function(){this.mxGraph&&this.mxGraph.destroy()}}]),E}();te()(Ee,"config",{mxImageBasePath:"images",mxLanguage:"none",mxLoadResources:!1,mxLoadStylesheets:!1}),te()(Ee,"VertexSize",{width:210,height:50});var ie=Ee,ue=e(63342),U=new ie,A=U.mxInstance,Oe=A.mxHierarchicalLayout,ne=A.mxCellHighlight,u=A.mxEvent,f=A.mxPopupMenu,y=A.mxEventObject,P=A.mxImage,I=A.mxUtils,oe=A.mxDragSource,le=A.mxGraph,we=A.mxShape,ce=A.mxConnectionConstraint,Ne=A.mxPoint,Be=A.mxPolyline,Ue=A.mxConstraintHandler,He=A.mxKeyHandler,Ve=A.mxClient,We="taier__widgets",Fe=Symbol("draggable");function Ze(E){var W=String.fromCharCode(E);if(W==="\b")return"\u232B"}function $e(E,W){var m=E.enableDrag,t=E.loading,L=t===void 0?!1:t,c=E.style,h=E.graphData,Pe=E.vertexKey,ye=Pe===void 0?"taskId":Pe,o=E.vertexSize,p=E.config,z=E.direction,se=E.children,de=E.onRenderCell,q=E.onRenderTooltips,H=E.onDrawVertex,S=E.onDrawEdge,me=E.onClick,ge=E.onContextMenu,je=E.onDoubleClick,d=E.onGetSize,D=E.onRenderWidgets,Z=E.onGetPreview,$=E.onDropWidgets,_e=E.onRenderActions,ke=E.onKeyDown,F=E.onCellsChanged,Se=E.onContainerChanged,he=(0,b.useRef)(null),n=(0,b.useRef)(),Ke=(0,b.useRef)([]),Xe=(0,b.useState)(null),Ye=T()(Xe,2),Je=Ye[0],ze=Ye[1];(0,b.useImperativeHandle)(W,function(){return{insertCell:function(r,i,g){if(n.current){var Q=(o==null?void 0:o.width)||ie.VertexSize.width,X=(o==null?void 0:o.height)||ie.VertexSize.height,J=H==null?void 0:H(r);n.current.insertVertex(n.current.getDefaultParent(),r[ye],r,i,g,Q,X,J);var N=n.current.getDefaultParent(),w=n.current.getChildVertices(N);w.length===1&&n.current.center(!0,!0,.55,.4)}},updateCell:function(r,i){if(n.current){var g=n.current.getModel().getCell(r);g&&(g.setValue(a()(a()({},g.value),i)),F==null||F(g),n.current.view.refresh())}},removeCell:function(r){if(n.current){var i=n.current.getModel().getCell(r);i&&n.current.removeCells([i],!0)}},getSelectedCell:function(){return n.current?n.current.getSelectionCell():null},getCells:function(){var r,i=((r=n.current)===null||r===void 0?void 0:r.getModel().getChildCells(n.current.getDefaultParent()))||[];return i},setCells:function(r){var i;(i=n.current)===null||i===void 0||i.addCells(r)},setView:function(r){n.current&&(n.current.view.setScale(r.scale),n.current.container&&setTimeout(function(){var i;(i=n.current)===null||i===void 0||i.container.scrollTo({top:r.scrollTop,left:r.scrollLeft})},0))}}});var qe=function(){n.current=U.create(he.current,p),U.createRubberBand(),U.renderVertex(function(r){return(de==null?void 0:de(r,n.current))||""}),U.renderTooltips(function(r){return q==null?void 0:q(r,n.current)}),U.layoutEventHandler=function(){var r=n.current.getDefaultParent();n.current.getModel().beginUpdate();try{var i=new Oe(n.current,z||"north");i.disableEdgeStyle=!1,i.interRankCellSpacing=60,i.intraCellSpacing=80,i.execute(r)}finally{n.current.getModel().endUpdate()}},U.initContainerScroll()},et=function(){var r=document.querySelectorAll('*[class*="'.concat(We,'"]'));r.forEach(function(i){if(!Object.hasOwnProperty(Fe)){var g=(Z==null?void 0:Z(i))||function(){var N=document.createElement("div");return N.innerHTML='<span class="preview-title">\u65B0\u8282\u70B9</span>',N}(),Q=(o==null?void 0:o.width)||ie.VertexSize.width,X=(o==null?void 0:o.height)||ie.VertexSize.height;g.style.width="".concat(Q,"px"),g.style.height="".concat(X,"px");var J=I.makeDraggable(i,function(N){var w=u.getClientX(N),x=u.getClientY(N),v=document.elementFromPoint(w,x);return v&&I.isAncestorNode(n.current.container,v)?n.current:null},function(N,w,x,v,j){N.canImportCell(x)&&($==null||$(i,N,x,v,j))},g,void 0,void 0,n.current.autoScroll,!0);J.createPreviewElement=function(){return g},J.isGuidesEnabled=function(){return n.current.graphHandler.guidesEnabled},J.createDragElement=oe.prototype.createDragElement,Object.defineProperty(i,Fe,{value:!0,writable:!1,enumerable:!1})}})},tt=function(){if(ke){var r=new He(n.current);r.getFunction=function(g){return g!==null&&!u.isAltDown(g)?this.isControlDown(g)||Ve.IS_MAC&&g.metaKey?u.isShiftDown(g)?this.controlShiftKeys[g.keyCode]:this.controlKeys[g.keyCode]:u.isShiftDown(g)?this.shiftKeys[g.keyCode]:this.normalKeys[g.keyCode]:null};var i=ke();Ke.current=i,i.forEach(function(g){var Q=g.method,X=g.keyCode,J=g.func;r[Q](X,function(){var N;(N=n.current)!==null&&N!==void 0&&N.isEnabled()&&J()})})}},nt=function(){m&&(Ue.prototype.pointImage=new P("images/points.gif",5,5),Ue.prototype.highlightColor="#3f87ff",le.prototype.getAllConnectionConstraints=function(r){if(r!=null&&r.shape){if(r.shape.stencil)return r.shape.stencil.constraints;if(r.shape.constraints)return r.shape.constraints}return[]},we.prototype.constraints=[new ce(new Ne(.5,0),!0),new ce(new Ne(0,.5),!0),new ce(new Ne(1,.5),!0),new ce(new Ne(.5,1),!0)],Be.prototype.constraints=[],n.current.connectionHandler.isConnectableCell=function(){return!1},n.current.isValidConnection=function(r,i){if(!r.vertex||!i.vertex)return!1;var g=this.getEdgesBetween(r,i);if(g.length>0)return!1;var Q=!1;return this.traverse(i,!0,function(X){if(r.id===X.id)return Q=!0,!1}),!Q})},rt=function(){var r,i,g,Q,X,J=[];(r=n.current)===null||r===void 0||r.addListener(u.ADD_CELLS,function(w,x){var v=x.getProperty("cell");F==null||F(v)}),(i=n.current)===null||i===void 0||i.addListener(u.REMOVE_CELLS,function(w,x){var v=x.getProperty("cell");F==null||F(v)}),(g=n.current)===null||g===void 0||g.addListener(u.MOVE_END,function(w,x){var v=x.getProperty("cell");F==null||F(v)}),(Q=n.current)===null||Q===void 0||Q.addListener(u.CLICK,function(w,x){var v=x.getProperty("cell");if(ze((v==null?void 0:v.value)||null),J.forEach(function(Ie){return Ie.destroy()}),(p==null?void 0:p.highlight)===!0)if(v)if(v.vertex)for(var j,re,Ae=((j=n.current)===null||j===void 0?void 0:j.getOutgoingEdges(v))||[],G=((re=n.current)===null||re===void 0?void 0:re.getIncomingEdges(v,n.current.getDefaultParent()))||[],B=Ae.concat(G),ve=0;ve<B.length;ve+=1){var fe=new ne(n.current,"#3f87ff",2),Ge=n.current.view.getState(B[ve]);fe.highlight(Ge),J.push(fe)}else{var pe=new ne(n.current,"#3f87ff",2),Te=n.current.view.getState(v);pe.highlight(Te),J.push(pe)}else{var ae,xe=n.current.getSelectionCells();(ae=n.current)===null||ae===void 0||ae.removeSelectionCells(xe)}v!=null&&v.vertex&&(me==null||me(v,n.current,x.getProperty("event")))}),(X=n.current)===null||X===void 0||X.addListener(u.DOUBLE_CLICK,function(w,x){var v=x.getProperty("cell");v&&v.vertex&&(je==null||je(v,n.current,x.getProperty("event")))});var N=f.prototype.showMenu;f.prototype.showMenu=function(){var w=this.graph.getSelectionCells()||[];if(w.length>0)N.apply(this,arguments);else return!1},n.current.popupMenuHandler.autoExpand=!0,f.prototype.popup=function(){var w=C()(Y()().mark(function x(v,j,re,Ae){return Y()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null)){B.next=8;break}for(this.div.style.left="".concat(v,"px"),this.div.style.top="".concat(j,"px");this.tbody.firstChild!=null;)u.release(this.tbody.firstChild),this.tbody.removeChild(this.tbody.firstChild);return this.itemCount=0,B.next=7,this.factoryMethod(this,re,Ae);case 7:this.itemCount>0&&(this.showMenu(),this.fireEvent(new y(u.SHOW),[]));case 8:case"end":return B.stop()}},x,this)}));return function(x,v,j,re){return w.apply(this,arguments)}}(),n.current.collapsedImage=new P("",0,0),n.current.popupMenuHandler.factoryMethod=function(){var w=C()(Y()().mark(function x(v,j){var re;return Y()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(j){G.next=2;break}return G.abrupt("return");case 2:return G.next=4,ge==null?void 0:ge(j.value,j,n.current);case 4:re=G.sent,re==null||re.forEach(function(B){var ve=B.id,fe=B.title,Ge=B.disabled,pe=B.children,Te=B.callback,ae=!!Ke.current.length&&!!ve&&Ke.current.find(function(Ie){return Ie.id===ve}),xe=v.addItem(ae?"".concat(fe,"(").concat(function(){switch(ae.method){case"bindControlKey":return Ve.IS_MAC?"\u2318":"Meta";case"bindKey":default:return""}}()," ").concat(Ze(ae.keyCode),")"):fe,void 0,function(){if(ae){ae.func();return}Te==null||Te()},void 0,void 0,!Ge);pe!=null&&pe.length&&pe.forEach(function(Ie){v.addItem(Ie.title,void 0,Ie.callback,xe,void 0,!Ie.disabled)})});case 6:case"end":return G.stop()}},x)}));return function(x,v){return w.apply(this,arguments)}}()},at=function(){if(h){var r;h.length===1&&ze(h[0]);for(var i=h.map(function(Q){return{sourceOrTarget:null,data:Q}}),g=function(){var X,J,N=i.pop(),w=N.sourceOrTarget,x=N.data,v=H==null?void 0:H(x),j=d==null?void 0:d(x),re=(j==null?void 0:j.width)||(o==null?void 0:o.width)||ie.VertexSize.width,Ae=(j==null?void 0:j.height)||(o==null?void 0:o.height)||ie.VertexSize.height,G=n.current.insertVertex(n.current.getDefaultParent(),x[ye],x,0,0,re,Ae,v);if(w){var B,ve,fe=!!((B=w.value)!==null&&B!==void 0&&(ve=B.childNode)!==null&&ve!==void 0&&ve.find(function(xe){return xe[ye]===x[ye]})),Ge=fe?w:G,pe=fe?G:w,Te=S==null?void 0:S(fe?w:G,fe?G:w);n.current.insertEdge(n.current.getDefaultParent(),null,null,Ge,pe,Te)}else{var ae;(ae=n.current)===null||ae===void 0||ae.setSelectionCell(G)}(X=x.childNode)!==null&&X!==void 0&&X.length&&x.childNode.forEach(function(xe){i.push({sourceOrTarget:G,data:xe})}),(J=x.parentNode)!==null&&J!==void 0&&J.length&&x.parentNode.forEach(function(xe){i.push({sourceOrTarget:G,data:xe})})};i.length;)g();(r=U.layoutEventHandler)===null||r===void 0||r.call(U),it()}},it=function(){window.setTimeout(function(){U.resetScrollPosition()},0)};return(0,b.useEffect)(function(){return qe(),at(),rt(),nt(),et(),tt(),function(){var M;(M=n.current)===null||M===void 0||M.destroy()}},[h]),(0,b.useEffect)(function(){var M;function r(){var i;Se==null||Se({scrollTop:he.current.scrollTop,scrollLeft:he.current.scrollLeft,scale:((i=n.current)===null||i===void 0?void 0:i.getView().getScale())||-1})}return(M=he.current)===null||M===void 0||M.addEventListener("scroll",r),function(){var i;(i=he.current)===null||i===void 0||i.removeEventListener("scroll",r)}},[]),(0,ue.jsxs)("div",{className:"dtc-graph-editor",style:c,children:[(0,ue.jsx)(ee.default,{tip:"Loading...",size:"large",spinning:L,wrapperClassName:"dtc-task-graph",children:(0,ue.jsx)("div",{style:{position:"relative",overflow:"auto",width:"100%",height:"100%"},tabIndex:-1,ref:he})}),D&&(0,ue.jsx)("div",{className:"dtc-graph-widgets",onContextMenu:function(r){return r.preventDefault()},children:D==null?void 0:D()}),(0,ue.jsx)("div",{className:"dtc-graph-bottom",children:se==null?void 0:se(Je)}),(0,ue.jsx)("div",{className:"dtc-graph-toolbar",style:p==null?void 0:p.toolbarStyle,children:_e==null?void 0:_e(n.current,U.mxInstance)})]})}var Qe=(0,b.forwardRef)($e)},24425:function(){}}]);
